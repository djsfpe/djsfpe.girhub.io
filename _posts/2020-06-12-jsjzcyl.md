---
layout: post
title:"计算机组成原理"
date:2020-06-12 00:00:00 +0800
desctiption：
---
# 计算机组成原理

## 计算机发展史：

第一代：电子管时代
第二代：晶体管时代
第三代：集成电路时代
第四代：大规模集成电路时代
第五代：超大规模集成电路时代
第一台计算机ENIAC：1946
微型计算机的发展以微处理器技术为标志

## 计算机系统：

* 软件：程序和数据，
* 硬件：计算机有型的部分，看得见，摸得着
二者关系：硬件是软件的载体

### 硬件：

*  主机（cpu，存储器），外设
*  总线，cpu（运算器，控制器，缓存），存储器（主存，辅存），io（输入设备，输出设备），接口
*  从生活装机角度：主板（对应系统总线以及一些芯片还有接口），处理器（就是cpu），内存（即主存）硬盘（辅存，操作系统和应用软件都是装在辅存上的）鼠标，键盘，显示器，网卡（io），显卡(接口）

#### 硬件指标：

* 机器字长：一次能处理的二进制最大位数
* 存储容量：存储数据的多少
* 运算速度：计算机执行指令的快慢，衡量单位MIPS（million instruction per second），CPI（clock cycle per instruction）FLOPS（flote-point operations per second）

BIOS（Basic input output system）：
位于主板
作用： 部分驱动及开机自检

### 软件：

* 系统软件：管理计算机软硬资源，为计算机应用软件开发和运行提供支持的软件
* 应用软件：为用户特定用途开发的软件，依赖和运行在系统软件之上。

### 冯诺依曼计算机体系：

* 计算机由五大部件组成
* 机器以运算器为中心，现在以存储器为中心
* 指令和数据以同等地位位于存储器，按地址找
* 指令和数据用二进制码表示
* 指令由操作码和地址码组成
* 指令在存储器中顺序存放

### 层次结构：

* 微指令系统
* 机器语言（实际机器M1）
* 操作系统（虚拟机器）
* 汇编语言（虚拟机器M2）
* 高级语言（虚拟机器M3）

### 语言分类：

* 机器语言
* 汇编语言
* 高级语言：解释型语言，编译型语言

## 总线（BUS）：

### 概念：

连接各个部件的信息传输线，是共享传输介质。

### 优点：

易扩展

### 信息传输方式：

串行，并行

### 3种结构 

面向cpu双总线：io总线，M总线
单总线
以存储器为中心的双总线：系统总线，存储总线（目前主流）

### 分类：

* 片内总线：芯片内部总线
* 系统总线：连接计算机部件
	+ 数据总线 双向
	+ 地址总线 单向（由cpu向外）
	+ 控制总线 都有,主要单向（由cpu向外）
*  通信总线：计算机系统之间，或者与网络设备
 俩种传输方式：串行，并行

### 性能指标：

总线宽度：数据线的数量
总线带宽：每秒传输的最大字节数（mbps）

总线原则：一发多收原则

总线控制：

### 总线判优控制：

#### 基本概念：

主设备：对总线有控制权
从设备：响应从主设备发来的总线命令

#### 总线判优控制：

* 集中式
	+ 链式查询
		+ 数据线
		+ 地址线
		+ 控制线（BS总线忙，BR总线请求，BG总线同意）
	+ 计数器定时查询
		+ 数据线
		+ 地址线
		+ 控制线（BS，BG，设备地址2^n>=设备数）
	+ 独立请求方式
		+ 数据线
		+ 地址线
		+ 控制线（每个外设对应一个BS，BG） 
* 分布式

#### 总线通信控制：

* 同步通信：通信双方按照统一时标进行数据传输（事先约定）
* 异步通信：双方无统一时标，按照应答方式进行数据传输（临时相约）
	+ 不互锁
	+ 半互锁
	+ 全互锁

比特（bit）：0，1
字节（byte）：8比特
字长：计算机一次处理数据的位数
字符：额，不知道咋说，就是字符，比如一个汉字就是一个字符，一个英文字母就是字符，一个数字也是字符。

波特率：全部二进制位
比特率：有效二进制位





















## 存储器：

### 概念：

计算机系统的记忆设备，存放程序和数据

B：byte字节，b：bit比特；二进制位 1B=8b
K=2^10 M=2^20 G=2^30 T=2^40 P ;均为数量级
计算机中的数量级和数学中的数量级不一样

### 存储器分类

* 按介质分：
	+ 半导体存储器（内存，ssd，u盘）
	+ 磁表面存储器（硬盘，磁带）
	+ 磁芯存储器（目前已淘汰）
	+ 光盘存储器
* 按存取方式分：
	+ 随机存储器（ram）：如今更多指一种可读可写的存储器
	+ 只读存储器（rom）
	+ 串行访问存储器(磁带)
	+ 直接存储器（磁盘：随机+串行的存储器）
* 按存储器的作用分：
	+ 主存：程序运行时保存指令和数据
		- 随机存储器（ram）
			* 静态ram（sram）
			* 动态ram（dram）
		- 只读存储器（rom）
			* MROM
			* PROM
			* EPROM
			* EEPROM
	+ 辅存：断电及关机后保存数据
		- 磁盘
		- 磁带
 		- 光盘
	+ 缓存（Cache）：提高cpu读取主存的速度
主存和辅存比较：
主存：速度高，位价高，容量小，半导体材料，易失性存储器，运行时存储程序和数据
辅存：速度低，位价低，容量大，多为半导体材料，非易失性存储器，脱机时程序和数据备份
位价：每一位的价格 

### RAM存储器的存储原理

存储器的最小存储单位是什么：byte（字节）逻辑单位（byte），物理单位（bit）
* SRAM：触发器原理：集成度更低（******），为了保存数据不丢失不需不断刷新，但一直有电流，因此功耗高；速度快，常用作缓存
* DRAM：电容原理：集成度更高（******），因为是电容原理，但绝缘体达不到理想状态，所以电量会不断丢失，为了保证数据不丢失需要不断刷新；速度慢，常用于主存。功耗较低

### ROM存储器

为什么叫只读存储器？因为写入太慢或不能写入

* MROM：掩模ROM
	特点：信息出厂时已近固化，用户不能修改写入
* PROM：
	特点：只能写入一次数据，需使用专门的编程设备。
* EPROM：
	特点：可以多次写入，但每次写入前需要通过紫外线照射擦除（光擦除）（整片擦除）
* EEPROM（E ^2PROM)：
	特点：可以多次擦除，多次写入，擦除可以在线电擦除（字擦除，块擦除），用于主板上的CMOS芯片
* 闪存：EPROM+EEPROM，用于手机/相机，固态硬盘，信息非易失，可以与cpu直接连接，具备了EEPROM及RAM的优点，集成度高，功耗低

### 高速缓冲存储器（catche）

作用：提高cpu与主存交换速率

工作原理：辅助硬件将cpu要用到的数据预取到catche中
如果cpu想要的数据从catch中拿到了的数据称之为命中，否则称之为未命中
辅助硬件不能%100将cpu要用到的数据命中
辅助硬件如何保证大概率将cpu需要的数据预取到catche中：程序局部性原理（程序访问局部性原理），即程序通常是顺序执行的，下一条要执行的语句大概率是在正在执行语句的附近 ，所以将正在执行语句附近的语句全部预装入catche中

catche对于cpu和程序员都是透明的

命中率=访问catche次数/（访问catche次数+访问主存次数）
平均访问时间=访问catche时间X命中率+访问主存时间X（1-命中率）
效率=catche访问时间/平均访问时间

#### catche主存地址映射

由主存地址映射到catche地址称之为地址映射
* 直接映射
	主存单元装入（映射）到catche单元的位置是固定的，因此，优点是映射简单，能由主存地址很快找到catche地址，工作效率高，但是会存在catche单元有空余的情况下，某个单元想要抢占一个已被占用单元的情况，导致catche利用率不高
	总结：映射效率高，catche利用率低
* 全相连映射
	特点：主存可以装入缓存的任何单元。因此，优点是主存单元数据装入catche的方式灵活，catche空间利用率高，但是需要对catche每个单元进行查找，工作效率低
	总结：映射效率低，catche利用率高
* 组相连映射
	特点：直接映射和全相联映射的折中，即把catche块分组对于组是直接映射，对于组内是全相联映射





### 存储芯片

存储器与存储芯片的关系，由存储芯片组成存储器

#### 存储芯片引脚的分类

* 电源和地
* 地址线：区分和选择存储器单元
* 数据线：传输存储单元内的数据
* 控制线：（读写信号：WR，RD，片选信号：CS）
	读写信号：确定数据的导通方向
	片选信号：确定数据线是否导通（即决定数据是否可读写）

地址线，数据线与芯片容量的关系
若地址线为X根，数据线为Y根，则芯片容量为2^xXY即2^X个单元

#### 由存储芯片组成存储器

3种方法
* 字扩展
* 位扩展
* 字位扩展

### 主存的技术指标

* 存储容量=存储单元X每个存储单元的位数（存储字长）：例如64kX8bit
* 存储速度
	+ 存取时间（存储器的访问时间）：是从启动存储器读写开始到读写结束的时间
	+ 存取周期：存储器连续俩次读或写的最小间隔时间，存取周期=存区时间+最小存取间隔时间
	+ 存储带宽：单位时间内存储器所读取的数据位数：MBps，bps。与存储字长和存储速度有关

### 存储器层次结构

* 寄存器
* 缓存
* 主存
* 磁盘
* 磁带

主存-辅存层：解决存储容量大的目标
缓存-主存层：解决存储器速度快的目标
最终达到效果，使cpu感觉存储容量和辅存相同，速度和缓存相同。

### 存储器的校验

* 奇偶校验
	+ 奇校验：在待校验的数据后面增加一位校验位，使全部二进制位中1的个数位奇数
	+ 偶校验：使全部二进制中1的个数为偶数
实际校验时奇偶校验选其一，所有校验都是通过在数据位之外增加冗余位来实现的
由于奇偶校验的原理，不能发现所有错误，只有当奇数个位出现错误时可以发现，偶数个位数出错时不能发现。
奇偶校验查错率>=%99，因为错X位不是等概率事件 
* 海明码校验：用于存储和通信领域，本质也属于奇偶校验，能发现多为错，能定位一位错，属于可纠错校验